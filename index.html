<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Christianssand | Konfigurator</title>
    <style>
        :root { 
            --forest-black: #141a17;
            --emerald-deep: #1e332d;
            --clay-warm: #a67c52;
            --linen: #f4f1ed;
            --vipps: #ff5b24;
            --klarna: #ffb3c7;
            --border-color: rgba(30, 51, 45, 0.2);
        }
        * { box-sizing: border-box; scroll-behavior: smooth; }
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(rgba(244, 241, 237, 0.95), rgba(244, 241, 237, 0.9)), url('static/christianssand_bg_new.jpg');
            background-size: cover; background-attachment: fixed; color: var(--forest-black); margin: 0; padding: 0; min-height: 100vh;
        }

        /* HEADER & FOOTER (Samme som f√∏r) */
        .top-bar { padding: 1rem 2rem; background: white; display: flex; align-items: center; border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100; justify-content: center; }
        .header-content { display: flex; align-items: center; gap: 1rem; flex-direction: column; }
        .header-title { font-size: 1.5rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--emerald-deep); margin: 0; }
        .header-subtitle { font-size: 0.7rem; letter-spacing: 0.12em; text-transform: uppercase; color: var(--clay-warm); }
        .main-logo { height: 60px; width: auto; }
        footer { background: var(--forest-black); color: white; padding: 3rem 2rem; text-align: center; margin-top: 4rem; }
        .footer-bottom { margin-top: 2rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.1); font-size: 0.7rem; color: #666; }

        .container { max-width: 1100px; margin: 0 auto; padding: 2rem 1.5rem; }

        /* CATEGORY GRID */
        .category-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 3rem; }
        .category-card { background: white; cursor: pointer; transition: 0.3s; border: 1px solid transparent; text-align: center; overflow: hidden; padding-bottom: 10px; }
        .category-card:hover { border-color: var(--clay-warm); transform: translateY(-3px); }
        .category-card img { width: 100%; height: 160px; object-fit: cover; }
        .category-info { padding: 0.8rem; }
        .category-info h3 { text-transform: uppercase; font-size: 0.85rem; letter-spacing: 0.1em; margin: 0; }
        .category-desc { font-size: 0.7rem; color: #777; font-style: italic; margin-top: 5px; }

        /* CONFIGURATOR SECTION */
        .config-container { background: white; padding: 2rem; box-shadow: 0 20px 40px rgba(0,0,0,0.05); border-top: 4px solid var(--emerald-deep); scroll-margin-top: 80px; }
        .config-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        
        label { display: block; margin-top: 1.5rem; font-size: 0.7rem; text-transform: uppercase; color: var(--clay-warm); font-weight: bold; }
        input, select { width: 100%; padding: 10px 0; border: none; border-bottom: 1px solid #ddd; font-size: 1.1rem; font-family: 'Georgia', serif; background: transparent; }
        
        /* NYTT: Knapper for valg av sett/figurer */
        .selection-btn {
            padding: 10px 15px; margin: 5px; border: 1px solid var(--clay-warm); background: white; cursor: pointer; font-family: 'Georgia', serif; transition: 0.2s;
        }
        .selection-btn:hover, .selection-btn.active { background: var(--clay-warm); color: white; }

        /* REALISTISK PREVIEW STYLING */
        .preview-box { 
            /* Standard bakgrunn f√∏r valg */
            background: #f4f4f4; 
            display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 8px; 
            min-height: 300px; /* Litt h√∏yere for √• vise innpakningen bedre */
            transition: all 0.5s ease; padding: 2rem; 
            position: relative;
            overflow: hidden; /* Viktig for at innholdet ikke skal stikke utenfor "r√∏ret" */
        }

        /* Simulering av R√òR (Tube Mode) */
        .preview-box.tube-mode {
            /* BYTT UT MED DITT BILDE: background-image: url('static/inside_tube.jpg'); */
            background: radial-gradient(circle at center, #e0d8d0 20%, #bdaea0 100%); /* Midlertidig CSS-simulering */
            border-radius: 50px; /* Runde hj√∏rner for √• simulere et r√∏r sett ovenfra */
            box-shadow: inset 0 5px 15px rgba(0,0,0,0.3); /* Innvendig skygge */
            padding: 1rem 3rem; /* Mer padding p√• sidene i r√∏ret */
        }

        /* Simulering av ESKE (Box Mode) */
        .preview-box.box-mode {
            /* BYTT UT MED DITT BILDE: background-image: url('static/inside_box.jpg'); */
            background: #f9f6f3; /* Lysere bakgrunn som silkepapir */
            border: 12px solid #d4c4b5; /* Tykk kant som simulerer eskekanten */
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
            border-radius: 4px;
        }

        .letter { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.3rem; font-weight: bold; box-shadow: 3px 3px 8px rgba(0,0,0,0.2); z-index: 2; }
        .buy-btn { background: var(--emerald-deep); color: white; border: none; padding: 1.2rem; width: 100%; text-transform: uppercase; cursor: pointer; margin-top: 2rem; letter-spacing: 0.2em; font-weight: bold; }
        .buy-btn:disabled { background: #eee; color: #aaa; }

        /* HANDLEKURV (Forenklet for oversiktens skyld) */
        #floating-cart { position: fixed; bottom: 10px; right: 10px; width: 300px; background: white; padding: 15px; z-index: 1000; display: none; border: 2px solid var(--emerald-deep); }

        @media (max-width: 768px) { .config-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="top-bar">
    <div class="header-content">
        <img src="static/logo_olav.jpg" alt="Logo" class="main-logo">
        <div class="header-text-group">
            <h1 class="header-title">Christianssand</h1>
            <span class="header-subtitle">H√•ndlagde fargestifter</span>
        </div>
    </div>
</div>

<div class="container">
    <div class="category-grid">
        <div class="category-card" onclick="setMode('studio')">
            <img src="static/ror.png" alt="R√∏r"><div class="category-info"><h3>Studio-R√∏r</h3><p class="category-desc">Klassisk r√∏r med eget navn.</p></div>
        </div>
        <div class="category-card" onclick="setMode('gave')">
            <img src="static/eske.png" alt="Eske"><div class="category-info"><h3>Gaveeske</h3><p class="category-desc">Eksklusiv eske med navn.</p></div>
        </div>
        <div class="category-card" onclick="setMode('abc')">
            <img src="static/abc.png" alt="Sett"><div class="category-info"><h3>Bokstavsett</h3><p class="category-desc">Ferdige sett (ABC, Tall).</p></div>
        </div>
        <div class="category-card" onclick="setMode('figurer')">
            <img src="static/figurer.png" alt="Figurer"><div class="category-info"><h3>Figurer</h3><p class="category-desc">Velg dine favorittfigurer.</p></div>
        </div>
    </div>

    <div id="konfigurator" class="config-container">
        <div class="config-layout">
            <div>
                <h2 id="config-title" style="margin-top:0;">Konfigurator</h2>
                
                <div id="selection-container" style="display:none; flex-wrap:wrap; gap: 5px; margin-bottom: 1rem;"></div>

                <div id="input-container">
                    <label id="input-label">Navn eller tekst</label>
                    <input type="text" id="nameInput" placeholder="SKRIV HER..." oninput="updateUIFromInput()" maxlength="12">
                </div>
                
                <label>Innpakning</label>
                <select id="pkgSelect" onchange="updatePreviewStyle()">
                    <option value="studio">Studio-r√∏r (Inkludert)</option>
                    <option value="gave">Eksklusiv Gaveeske (+89,-)</option>
                </select>

                <div style="font-size: 2rem; margin: 1.5rem 0; font-weight: bold;" id="totalPrice">0 kr</div>
                <button id="buyBtn" class="buy-btn" onclick="addToCart()" disabled>Legg i handlekurv</button>
            </div>
            
            <div class="preview-box" id="preview">
                <p style="color: #999; font-style: italic;">Gj√∏r dine valg til venstre...</p>
            </div>
        </div>
    </div>
</div>

<footer>
    <div class="footer-bottom">&copy; 2026 Christianssand.</div>
</footer>

<div id="floating-cart">
    <h3>Handlekurv <span id="cart-count">0</span></h3>
    <p>Totalt: <span id="cart-total">0 kr</span></p>
    <button style="width:100%; background:var(--vipps); border:none; color:white; padding:10px;">VIPPS</button>
</div>

<script>
    let cart = [];
    const colors = ['#1e332d', '#8b7355', '#556b2f', '#483c32', '#6b705c'];
    let currentMode = 'studio';
    let currentSelectionContent = ''; // Holder styr p√• innholdet fra knapper

    // DATA FOR SETT OG FIGURER
    const letterSets = [
        { name: "ABC Sett", content: "ABC" },
        { name: "123 Sett", content: "123" },
        { name: "VOKALER", content: "AEIOUY√Ü√ò√Ö" }
    ];
    
    // Her bruker vi emojis midlertidig som ikoner for figurene
    const figureOptions = [
        { name: "Dino", icon: "ü¶ñ" },
        { name: "Bil", icon: "üöó" },
        { name: "Hjerte", icon: "‚ù§" },
        { name: "Stjerne", icon: "‚≠ê" },
        { name: "Bj√∏rn", icon: "üêª" }
    ];

    function setMode(mode) {
        currentMode = mode;
        const title = document.getElementById('config-title');
        const inputContainer = document.getElementById('input-container');
        const selectionContainer = document.getElementById('selection-container');
        const pkgSelect = document.getElementById('pkgSelect');

        document.getElementById('konfigurator').scrollIntoView();
        selectionContainer.innerHTML = ''; // T√∏m gamle knapper
        currentSelectionContent = ''; // Nullstill valg
        document.getElementById('nameInput').value = ''; // Nullstill tekstfelt

        if (mode === 'abc') {
            title.innerText = "Velg ferdig sett";
            inputContainer.style.display = 'none';
            selectionContainer.style.display = 'flex';
            pkgSelect.value = 'gave'; // Sett standard til eske

            // Lag knapper for bokstavsett
            letterSets.forEach(set => {
                const btn = document.createElement('button');
                btn.className = 'selection-btn';
                btn.innerText = set.name;
                btn.onclick = () => selectPredefinedSet(set.content, btn);
                selectionContainer.appendChild(btn);
            });

        } else if (mode === 'figurer') {
            title.innerText = "Klikk for √• velge figurer";
            inputContainer.style.display = 'none';
            selectionContainer.style.display = 'flex';
            pkgSelect.value = 'studio'; // Sett standard til r√∏r

            // Lag knapper for figurer
            figureOptions.forEach(fig => {
                const btn = document.createElement('button');
                btn.className = 'selection-btn';
                btn.innerHTML = fig.icon + " " + fig.name;
                btn.onclick = () => addFigure(fig.icon);
                selectionContainer.appendChild(btn);
            });

        } else {
            // Studio eller Gave modus (Tekst-input)
            title.innerText = mode === 'gave' ? "Navn i Gaveeske" : "Navn i Studio-r√∏r";
            inputContainer.style.display = 'block';
            selectionContainer.style.display = 'none';
            pkgSelect.value = mode;
        }
        updatePreviewStyle();
        renderPreview();
    }

    // H√•ndterer klikk p√• ferdige sett (ABC, 123)
    function selectPredefinedSet(content, clickedBtn) {
        currentSelectionContent = content;
        // Marker aktiv knapp
        document.querySelectorAll('.selection-btn').forEach(b => b.classList.remove('active'));
        clickedBtn.classList.add('active');
        renderPreview();
    }

    // H√•ndterer klikk p√• figurer (legger til en og en)
    function addFigure(icon) {
        currentSelectionContent += icon;
        renderPreview();
    }

    // H√•ndterer skriving i tekstfeltet
    function updateUIFromInput() {
        const input = document.getElementById('nameInput');
        // Tillat kun bokstaver og tall
        currentSelectionContent = input.value.toUpperCase().replace(/[^A-Z√Ü√ò√Ö0-9]/g, '');
        input.value = currentSelectionContent;
        renderPreview();
    }

    // Oppdaterer stilen p√• preview-boksen (R√∏r vs Eske)
    function updatePreviewStyle() {
        const pkg = document.getElementById('pkgSelect').value;
        const preview = document.getElementById('preview');
        if (pkg === 'gave') {
            preview.classList.remove('tube-mode');
            preview.classList.add('box-mode');
        } else {
            preview.classList.remove('box-mode');
            preview.classList.add('tube-mode');
        }
        renderPreview();
    }

    // Tegner opp selve innholdet i preview-boksen og regner pris
    function renderPreview() {
        const preview = document.getElementById('preview');
        const pkg = document.getElementById('pkgSelect').value;
        preview.innerHTML = '';

        if (currentSelectionContent.length === 0) {
            preview.innerHTML = '<p style="color: #999; font-style: italic;">Gj√∏r dine valg...</p>';
            document.getElementById('totalPrice').innerText = '0 kr';
            document.getElementById('buyBtn').disabled = true;
            return;
        }

        // Lag brikkene. Hvis det er figurer (emojis), bruker vi dem direkte. Ellers bokstaver.
        const items = Array.from(currentSelectionContent); // H√•ndterer b√•de tekst og emojis riktig
        items.forEach((item, i) => {
            const div = document.createElement('div');
            div.className = 'letter';
            div.innerText = item;
            // Bruk fargepalett kun hvis det ikke er en emoji-figur (forenklet sjekk)
            if (!item.match(/\p{Emoji}/u)) {
                 div.style.background = colors[i % colors.length];
            } else {
                 div.style.background = '#fff'; // Hvit bakgrunn for emojis
                 div.style.color = '#000';
                 div.style.fontSize = '1.8rem';
            }
            preview.appendChild(div);
        });

        // Prisberegning
        let pricePerUnit = 95;
        // Gi rabatt hvis det er et ferdig sett
        if (currentMode === 'abc') pricePerUnit = 85;

        const total = (items.length * pricePerUnit) + (pkg === 'gave' ? 89 : 0);
        document.getElementById('totalPrice').innerText = total + ' kr';
        document.getElementById('buyBtn').disabled = false;
    }

    // Enkel handlekurv-logikk for demo
    function addToCart() {
        const pkg = document.getElementById('pkgSelect').value;
        const price = parseInt(document.getElementById('totalPrice').innerText);
        cart.push({ content: currentSelectionContent, pkg, price });
        document.getElementById('cart-count').innerText = cart.length;
        document.getElementById('cart-total').innerText = cart.reduce((sum, item) => sum + item.price, 0) + ' kr';
        document.getElementById('floating-cart').style.display = 'block';
        
        // Reset
        currentSelectionContent = '';
        document.getElementById('nameInput').value = '';
        document.querySelectorAll('.selection-btn').forEach(b => b.classList.remove('active'));
        renderPreview();
        alert("Lagt i kurven!");
    }
</script>

</body>
</html>
